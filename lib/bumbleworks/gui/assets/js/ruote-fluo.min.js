/* ruote-fluo-2.3.1.min.js | MIT license: http://github.com/jmettraux/ruote-fluo/LICENSE.txt */
$.fn.computedStyle=function(){var f=this.get(0);var b;var h={};if(window.getComputedStyle){var d=function(k,i){return i.toUpperCase()};b=window.getComputedStyle(f,null);for(var g=0,e=b.length;g<e;g++){var a=b[g];var j=a.replace(/\-([a-z])/g,d);var c=b.getPropertyValue(a);h[j]=c}return h}if(b=f.currentStyle){for(var a in b){h[a]=b[a]}return h}if(b=f.style){for(var a in b){if(typeof b[a]!="function"){h[a]=b[a]}}return h}return h};var RuoteFluo=(function(){var r="2.3.1";var j=7;var a=4;var k=this;function c(A){var x=["defs",[]];x[1].push(["marker",{id:"arrowhead",viewBox:"0 0 100 100",refX:"90",refY:"50",markerUnits:"strokeWidth",markerWidth:"10",markerHeight:"10",orient:"auto"},[["path",{"class":"fluo",d:"M 0 0 L 100 50 L 0 100 Z"}]]]);var B=["g",{id:"timer"},[["circle",{"class":"fluo",cx:"14",cy:"14",r:"14",fill:"none",stroke:"black","stroke-width":"1"}],["circle",{"class":"fluo",cx:"14",cy:"14",r:"10",fill:"none",stroke:"black","stroke-width":"1"}],["path",{id:"tt","class":"fluo",d:"M 14 05 L 14 07",fill:"none",stroke:"black","stroke-width":"1"}]]];for(var z=0;z<12;z++){var y=(z+1)*30;B[2].push(["use",{"xlink:href":"#tt",transform:"rotate("+y+", 14, 14)"}])}B[2].push(["path",{"class":"fluo",d:"M 14 10 L 14 14",fill:"none",stroke:"black","stroke-width":"1",transform:"rotate(120, 14, 14)"}]);B[2].push(["path",{"class":"fluo",d:"M 14 08 L 14 14",fill:"none",stroke:"black","stroke-width":"1"}]);x[1].push(B);f(A,x)}function p(D,B,x,C,A){B=B||"svg";x=x||{};A=A||{};var y=document.createElementNS("http://www.w3.org/2000/svg",B);Nu.each(x,function(G,F){var H=null;var E=G.match(/^([a-z]+):([a-z-]+)$/);if(E){H=E[1]}if(H==="xlink"){H="http://www.w3.org/1999/xlink"}if(F instanceof Array){F=F.join(" ")}y.setAttributeNS(H,G,F)});var z=$(y);if(C){z.append(document.createTextNode(C))}D[A.prepend?"prepend":"append"](z);if(B==="svg"){c(z)}return z}function f(C,x){var z=x[0];var y=x[1];var A=x[2]||[];if(y instanceof Array){A=y;y={}}var B=p(C,z,y);Nu.each(A,function(D){f(B,D)});return B}function m(B,z,x,A,y){if(z instanceof Array){return f(B,z)}else{return p(B,z,x,A,y)}}function n(x){if(x.width()===0){return g(x).width}else{return x.width()}}function l(x){if(x.height()===0){return g(x).height}else{return x.height()}}function s(x){return Nu.max(Nu.map(x.children(),function(y){return n($(y))}))}function u(x){return Nu.reduce(Nu.map(x.children(),function(y){return l($(y))}),0,function(z,y){return z+y})}function t(A,z){var x=m(A,"g");var B=0;Nu.each(z,function(C){var y=C;var E="";if(C instanceof Array){E=C[0];y=C[1]}var D=m(x,"text",{"class":$.trim("fluo "+E),x:0},y);B=B+l(D);D.attr("y",B)});x._width=s(x);x._height=u(x);return x}function v(y){var x=Nu.inject(y,0,function(z,A){return Nu.max([z,A._width,A._center||0])});Nu.each(y,function(A){var z=(x-A._width)/2;var B=A._center;if(B){z=(x-B)/2}i(A,z,0)})}function w(y){var x=(y.attr("transform")||"").match(/^translate\((\d+(?:\.\d+)?),? (\d+(?:\.\d+)?)\)$/);if(!x){return{x:0,y:0}}return{x:parseFloat(x[1]),y:parseFloat(x[2])}}function g(x){var z=x[0].getBBox();var y=w(x);return{x:y.x,y:y.y,width:z.width,height:z.height}}function i(A,z,C){var B=w(A);A.attr("transform","translate("+(B.x+z)+", "+(B.y+C)+")")}function e(E,y,x,C,B,A){var D=null;var z=a;if(!A.bottom){D=["M",y,x,"L",C+(C>y?-1:1)*z,x,"Q",C,x,C,x+z,"L",C,B];if(A.inner){D=["M"].concat(D.slice(4))}}else{D=["M",y,x,"L",y,B-z,"Q",y,B,y+(C>y?1:-1)*z,B,"L",C,B];if(A.inner){D=D.slice(0,11)}}return m(E,"path",{"class":"fluo rounded_path",d:D,fill:"none"})}function b(x){var y=Nu.find(x[1],function(B,A){return(A===null)});if(y){y=y[0]}var z=Nu.select(x[1],function(B,A){return(A!=null)});return[y,z]}function o(K,E,z,C,y){y=y||{};var A=m(K,"g",{"class":"fluo card"});var H=(y.noCard||y.noRect)?null:m(A,"rect",{"class":"fluo"});var M=null;if(y.noCard){M={_height:0,_width:0}}else{var L=b(z);var B=[["expname",z[0]+(L[0]?" "+L[0]:"")]];Nu.each(L[1],function(N,x){B.push(N+": "+x)});M=t(A,B);i(M,a,0)}var I=M._width;if(!y.noCard){I=I+2*a}var D=m(A,"g",{"class":"fluo card_body"});i(D,I,0);var G=C(D);var J=G[0];var F=G[1];A._width=I+J+(H?a:0);A._height=Nu.max([M._height,F]);if(!y["short"]&&!y.noCard){A._height=A._height+2*a}if(H){H.attr("rx",j);H.attr("ry",j);H.attr("width",""+A._width);H.attr("height",""+A._height)}if(y.rightCentered){A._center=(A._width-J/2-a)*2}A._body=D;return A}var h={};h.text=function(z,y,x){var B=JSON.stringify(x[1]).slice(1,-1);var A=m(z,"text",{"class":"fluo text_exp"},$.trim(x[0]+" "+B));A._width=n(A);A._height=l(A)+a;A.attr("y",l(A));return A};h.any=function(z,y,x){return o(z,y,x,function(D){var B=0;var C=a;var A=0;Nu.each(x[2],function(F){var E=d(D,y+"_"+B,F);i(E,0,C);B=B+1;C=C+E._height+a;A=Nu.max([A,E._width])});return[A,C]})};h.sequence=function(A,y,x){var z=Nu.isEmpty(x[1]);return o(A,y,x,function(F){var D=0;var E=z?0:a;var B=0;var C=Nu.map(x[2],function(I){var G=d(F,y+"_"+D,I);i(G,0,E);D=D+1;E=E+G._height;B=Nu.max([B,G._width]);if(D>=x[2].length){return G}var H=m(F,"path",{"class":"fluo",d:"M 0 0 L 0 11","marker-end":"url(#arrowhead)"});i(H,0,E);E=E+11;H._width=n(H);H._height=l(H);return[G,H]});v(Nu.flatten(C));return[B,E]},{noCard:z})};h.concurrence=function(B,z,x){var D=o(B,z,x,function(H){var F=0;var E=0;var G=Nu.map(x[2],function(J){var I=d(H,z+"_"+F,J);i(I,E,a);E=E+I._width+a;F=F+1;return I._height});return[E-a,Nu.max(G)]},{noRect:true,rightCentered:true});var C=n(D._body);var y=0;var A=D._body.children().length;Nu.each(D._body.children(),function(I){y=y+1;var H=$(I);var F=n(H);var G=l(H);var E=w(H).x;e(D._body,C/2-a,0,E+F/2,a,{bottom:false,inner:y>1&&y<A});e(D._body,E+F/2,G+a,C/2-a,D._height,{bottom:true,inner:y>1&&y<A})});return D};h.wait=function(z,y,x){return o(z,y,x,function(A){var B=m(A,"use",{"xlink:href":"#timer"});return[2*a+n(B),l(B)]},{noRect:true,"short":true,rightCentered:true})};h.sleep=h.wait;Nu.each(["set","rset","unset","rewind","continue","back","break","stop","cancel","skip","jump"],function(x){h[x]=h.text});function d(A,z,y){var x=(h[y[0]]||h.any).call(k,A,z,y);x[0].id="exp_"+z;return x}function q(x){if(x.jquery){return x}if((typeof x)!=="string"){return $(x)}if(x.match(/[\.#\[]/)){return $(x)}return $("#"+x)}this.render=function(y,z,x){x=x||{};$div=q(y);$div.empty();$div[0].ruote_fluo_options=x;$div[0].ruote_fluo_definition=z;$g=d(m($div),"0",z);if(x.noOuterBorder){$g.children("rect").remove()}var G=$g._width+3;var D=$g._height+3;var E=G;var B=D;var A=x.width||x.w;var F=x.height||x.h;if(x.fit){E=$div.innerWidth()-8;B=$div.innerHeight()-8}else{if(A){E=A;B=F}}if(x.fit==="down"&&G<E){E=G;B=D}if(E<0||B<0){E=20;B=20}var C=x.preserveAspectRatio||x.par||"xMidYMin meet";$svg=$g.parent();$svg.attr("class",("ruote_fluo "+($svg.attr("class")||"")).trim());$svg[0].setAttributeNS(null,"viewBox","0 0 "+G+" "+D);$svg[0].setAttributeNS(null,"preserveAspectRatio",C);$svg.attr("width",""+E+"px");$svg.attr("height",""+B+"px");$svg.attr("data-ruote-fluo-scale",""+(E/G));return $g};this.highlight=function(D,B){var z=q(D);$("#"+z[0].id+" rect.fluo_highlight").remove();var A=$("#exp_"+B);if(A.length<1){return}var y=g(A);var x=m(A.parent(),"rect",{"class":"fluo_highlight"},null,{prepend:true});var C=parseFloat(x.computedStyle()["stroke-width"]||"3")+1;x.attr({x:y.x-C,y:y.y-C,width:y.width+2*C,height:y.height+2*C,rx:C,ry:C})};this.pin=function(x,A,F,y){F="fluo_pin fluo_pin_"+F;y=y||"wi";var H=q(x);var z=$("#exp_"+A);if(z.length<1){return}var I=g(z);var J=20;var C=10;var D=40;var G=15;var K=m(z.parent(),"g");var E=m(K,"path",{d:["M",0,G,"L",C,D,"L",J,G,"Q",C,0,0,G],"class":F});var B=m(K,"text",{"class":F,x:J/4,y:D/2},y);v([E,B]);i(K,I.x+I.width-18,I.y-20)};this.computeHeight=function(D,A){var y=q(D);var C=y.children("svg")[0].attributes.viewBox.value.split(" ");var x=parseInt(C[2],10);var z=parseInt(C[3],10);var B=x/A;return Math.round(z/B)};return this}).apply({});var Fluo=RuoteFluo;
/* compressed from commit e8ba2a6 */
